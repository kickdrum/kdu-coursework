<!DOCTYPE html>
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Prashant's Page</title>
        <link rel="stylesheet" href="style.css">
    </head>
    <body>
        <div class="header">
            <h1 class="heading">KDU Stock Market Dashboard</h1>
        </div>
        <script src="https://cdn.socket.io/4.7.4/socket.io.min.js" integrity="sha384-Gr6Lu2Ajx28mzwyVR8CFkULdCU7kMlZ9UthllibdOSo6qAiN+yXNHqtgdTvFXMT4" crossorigin="anonymous"></script>

        <script>
            

        </script>
        <div class="main">
            <div class="stats">
                <div class="tabs">
                    <div class="zomato">
                        <div class="zomato-logo">
                            <img src="./zomato.jpg">
                        </div>
                        <div id="zomato-text" class="zomato-text">
                            
                        </div>
                            
                    </div>
                    <div class="price">
                        <div><p>Price</p></div>
                        <div id="prices">

                        </div>
                    </div>
                    <div class="quantity">
                        <input class="input" type="text" id="msgInput" placeholder="Enter QTY">

                    </div>
                    <div class="buy">
                        <button id="buy">BUY</button>
                    </div>
                    <div class="sell">
                        <button id="sell">SELL</button>
                    </div>

                </div>
                <div class="graph-div">
                    <div class="grid">
                    <hr>
                    <hr>
                    <hr>
                    <hr>
                    <hr>
                    </div>
                    
                </div>
            </div>

            <div class="history">
                <p class="history-text">History</p>
                <div id="history-messages"></div>
            </div>

        </div>

        <div id="messages"></div>


        <script>
            const socket = io("http://localhost:5000");

            const zomatoText=document.getElementById("zomato-text");
            function addZomatoText(message){
                const text=document.createElement('p');
                text.innerText=message;
                zomatoText.appendChild(text);
            }

            const stockPrice=document.getElementById("prices")
            function addPrice(price){
                const text=document.createElement('p');
                text.innerText=price;
                stockPrice.appendChild(text);
            }

            const messageInput=document.getElementById("msgInput");
            const buy=document.getElementById("buy");
            const historyBuy=document.getElementById("history-messages");

            function addHistoryBuy(qty){
                // console.log("price test function");
                const divMessage=document.createElement('div');
                divMessage.classList.add('divMessage');

                const divLeft=document.createElement('div');
                divLeft.classList.add('divLeft');
                const divRight=document.createElement('div');
                divRight.classList.add('divRight');

                const divLeftTop=document.createElement('div');
                divLeftTop.classList.add('divLeftTop');
                const divLeftBottom=document.createElement('div');
                divLeftBottom.classList.add('divLeftBottom');

                const element=document.createElement('p');
                element.innerText="BUY";
                divRight.appendChild(element);

                const element1=document.createElement('p');
                element1.innerText=qty+" stocks";
                divLeftTop.appendChild(element1);

                var currentdate = new Date(); 
                var datetime = currentdate.getDate() + "/"
                + (currentdate.getMonth()+1)  + "/" 
                + currentdate.getFullYear() + " "  
                + currentdate.getHours() + ":"  
                + currentdate.getMinutes() + ":" 
                + currentdate.getSeconds();

                const element3=document.createElement('p');
                element3.innerText=datetime;
                divLeftBottom.appendChild(element3);

                divLeft.appendChild(divLeftTop);
                divLeft.appendChild(divLeftBottom);

                divMessage.appendChild(divLeft);
                divMessage.appendChild(divRight);

                historyBuy.appendChild(divMessage);
                
            }

            buy.addEventListener("click", ()=>{
                const message=messageInput.value;
                // console.log("price test");
                addHistoryBuy(message);

            })

            socket.on("receive-zomato-text",(message)=>{
                addZomatoText(message);
            })

            socket.on("receieve-prices",(price)=>{
                addPrice(price);
            })

        </script>
    </body>
</html>